% Latex Template - Distributed Systems Group - UC Berkeley 2020

% Last Updated 16/2/2023
% Compliance against ACM (SOSP/HotOS)
% Compliance against Usenix
% Compliance against PODC/DISC
% Compliance against SIGMOD
% Compliance against VLDB


% Template Options
% ================================================
\usepackage{etoolbox}
% If set, ensures that all comments are removed
\newbool{publicversion}
% If set, ensures that is appropriately referred to as TR
\newbool{tr}
% If set, ensures that appropriate elements are anonymised
\newbool{optanon}
% If set, activates space saving tricks
\newbool{compress}
% If set, activates Usenix formatting
\newbool{usenix}
% If set, activates ACM formatting for SIGPLAN style (SOSP, Eurosys)
\newbool{sigplan}
% If set, activates ACM formatting for SIGCONF style (SIGMOD)
\newbool{sigconf}
% If set, activates LIPCS formatting for LIPCS style (PODC, DISC)
\newbool{lipcs}
%% If set, activates packages not officially allowed by ACM
\newbool{sigplan-danger}

% ================================================
% Default values
% ================================================
\setbool{tr}{true}
\setbool{publicversion}{true}
\setbool{compress}{true}
\setbool{optanon}{true}
\setbool{usenix}{true}
\setbool{sigplan}{false}
\setbool{sigconf}{false}
\setbool{lipcs}{false}
\setbool{sigplan-danger}{true}

% ================================================
% Package list. Please add packages alphabetically with a quick note of what they do
% ================================================

% These packages are not officially supported by the ACM (https://authors.acm.org/proceedings/production-information/accepted-latex-packages. Last Checked 16/2/23)
\ifbool{sigplan-danger}{
%\usepackage{array}
%\usepackage{appendix}
%\usepackage{booktabs} % for toprule andm midrule in tables
%\usepackage{blindtext}
\usepackage[font={it,small}]{caption,subcaption}
%\usepackage{cancel}
%\usepackage{changepage}
%\usepackage[xcolor]{changebar}
%%\usepackage{filecontents}
%\usepackage[english]{babel}
%\usepackage{epsfig}
%\usepackage{lipsum} % Used for inserting dummy 'Lorem ipsum' text into the template
%\usepackage{makecell} % easy way to break lines latex
%\usepackage{mdframed}
%\usepackage{parskip}
%\usepackage{tikz}
%\usetikzlibrary{positioning}
%\usetikzlibrary{patterns}
%\usepackage[normalem]{ulem}
%\usepackage{xurl}
}

\usepackage[noend]{algorithmic}
\usepackage{amsthm}
\usepackage{amsmath}
\usepackage{balance}
\usepackage{color}
\usepackage{comment} % enables easy commenting of lines of text
%\usepackage{draftwatermark}
\usepackage[shortlabels]{enumitem} %adds an easy way to customise margins for enums and itemize, incompatible with savetrees[moderate]
\usepackage[export]{adjustbox}
\usepackage{etoolbox}
\usepackage{listings}
\usepackage{longfbox}
\usepackage{fancybox}
\usepackage{geometry}
\usepackage{hyperref} 
\usepackage[utf8]{inputenc}
\usepackage{multirow}
\usepackage{pifont}% http://ctan.org/pkg/pifont
%\usepackage{pseudocode}
\usepackage[colorinlistoftodos]{todonotes} % Allows for commenting in the marging
\usepackage[compact]{titlesec}
\usepackage{setspace}
\usepackage[binary-units,group-separator={,}]{siunitx}
%\usepackage{subfigure}
\usepackage{textcomp}
\usepackage{url}
\usepackage{xspace}
\usepackage{xcolor}

% PDF Configuration
% ================================================
% Format PDF
\hypersetup{breaklinks=true,
  bookmarks=true, pdfauthor={Gupta, Suyash}, pdftitle={Scrooge},
  colorlinks=true,
  citecolor=blue,
  urlcolor=blue,
  linkcolor=blue,
  pdfborder={0 0 0}}

\frenchspacing


% ================================================

% Conference Style 
% ================================================
\ifbool{usenix}{
    % Makes sure that the usenix package is regularly updated
    \usepackage{usenix-16-2-23}
    % These packages are not compatible with ACM
    \usepackage[numbers,sort&compress,square]{natbib}
    \usepackage[normalem]{ulem} % Defines strikeout Breaks bibtex
}{
    \ifbool{sigplan} {
    
    }{}
}




% ================================================

% Commenting Options 
% ================================================
\definecolor{gold}{RGB}{218,165,32}
\definecolor{lightblue}{rgb}{0.6,1.0,0.6}
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}

% Define a changebar mechanism to delete text
\newcommand{\deleted}[1]{%
  \cancel{#1}
 }

% Define a changebar mechanism to add text
\newcommand{\added}[1]{%
  \cbcolor{green}
  \begin{changebar}
    #1
  \end{changebar}%
  }%
  
\setlength{\textheight}{9.0in}
\setlength{\columnsep}{0.33in}
\setlength{\textwidth}{7.00in}

\setlength{\topmargin}{0.0in}

\setlength{\headheight}{0.0in}

\setlength{\headsep}{0.0in}

\addtolength{\oddsidemargin}{-0.25in}
\addtolength{\evensidemargin}{-0.25in}


\ifbool{publicversion}{
  % Comments deactivated
  % \SetWatermarkText{}
  \newcommand{\grumbler}[2]{}
  \newcommand{\grumblermargin}[3]{}
  \newcommand{\changebars}[2]{#1}
  \newcommand{\pagelimit}[1]{}
  \newcommand{\todos}[1]{}
} 
{
  \newcommand{\grumbler}[2]{{{\bf #1:} #2}}
  
  % \setlength{\marginparwidth}{1.5cm}
  \newcommand{\grumblermargin}[3]{\todo[size=\tiny,color=#3, nolist]{{\bf #1:} #2}}
  \newcommand{\pagelimit}[1]{{\hl{ #1 pages }}}
  \newcommand{\changebars}[2]{{\added{#1}}{\sout{#2}}}
  \newcommand{\todos}[1]{\todo[size=\small, inline]{#1}}
}


  
% ================================================

% ================================================

% Space-saving Options 
% ================================================
\ifbool{compress}{
%   \setlength{\tabcolsep}{0.25in}
  \setlist[itemize]{leftmargin=*}
  \setlist[enumerate, 1]{1.} %{leftmargin=*}
  \setlist{itemsep=0pt,parsep=0pt}             % more compact lists
  \usepackage[subtle,wordspacing=normal]{savetrees} % Saves space
  \setlength{\parskip}{2pt plus 1mm minus 1mm} %No line skip
  \setlength{\parindent}{5pt} % Default is 15pt. 
  \setlength\abovedisplayskip{2pt plus 2pt minus 2pt}% minimises space above display maths
  \setlength\belowdisplayskip{2pt plus 2pt minus 2pt}% minimises space below displaymaths
  \setlength{\abovecaptionskip}{1pt} % minimises space below caption
  \setlength{\belowcaptionskip}{1pt} % minimises space below caption
  \setlength\floatsep{2pt plus  0pt minus 0pt}
  \setlength\textfloatsep{3pt plus 0pt minus 0pt}
} 
{
}

% ================================================


% Anonymising options
% ================================================
 \ifbool{optanon}%
   {\newcommand{\anonAndNonAnon}[2]{#1}}%
   {\newcommand{\anonAndNonAnon}[2]{#2}}
% ================================================
 
% Technical Report Options
% ================================================
 \ifbool{tr}{
    \newcommand{\tr}[2]{#1}
}
{
    \newcommand{\tr}[2]{#2}
}
% ================================================
 

% Supplemental Commands 
% ===============================================
% Experiments
% Checkmarks
\newcommand{\cmark}{\ding{51}}%
\newcommand{\xmark}{\ding{55}}%


% Enumeration
\newcommand{\one}{({\em i}\/)\xspace}
\newcommand{\two}{({\em ii}\/)\xspace}
\newcommand{\three}{({\em iii}\/)\xspace}
\newcommand{\four}{({\em iv}\/)\xspace}
\newcommand{\five}{({\em v}\/)\xspace}

% Symbols
\newcommand{\tinydag}{\textsuperscript{\dag}}
\newcommand{\tinyddag}{\textsuperscript{\ddag}}
\newcommand{\tinystar}{\textsuperscript{\S}}

% Table Formatting
% Define table new line
\newcommand{\tabincell}[2]{\begin{tabular}{@{}#1@{}}#2\end{tabular}}
%Align left single column
\newcommand{\alignleft}[1]{\multicolumn{1}{l}{#1}}
%Align right single column
\newcommand{\alignright}[1]{\multicolumn{1}{r}{#1}}
%Align center single column
\newcommand{\aligncenter}[1]{\multicolumn{1}{c}{#1}}


% Theorems
\newtheoremstyle{indented}
{1pt}   % ABOVESPACE
{1pt}   % BELOWSPACE
{\itshape}  % BODYFONT
{1pt}       % INDENT (empty value is the same as 0pt)
{\bfseries} % HEADFONT
{}         % HEADPUNCT
{2pt plus 1pt minus 1pt} % HEADSPACE
{}          % CUSTOM-HEAD-SPEC

\newtheoremstyle{noindent}
{2pt}   % ABOVESPACE
{2pt}   % BELOWSPACE
{\itshape}  % BODYFONT
{0pt}       % INDENT (empty value is the same as 0pt)
{\bfseries} % HEADFONT
{}         % HEADPUNCT
{2pt plus 1pt minus 1pt} % HEADSPACE
{}          % CUSTOM-HEAD-SPEC

\newtheoremstyle{definition-compressed}
{2pt}   % ABOVESPACE
{2pt}   % BELOWSPACE
{\itshape}  % BODYFONT
{0pt}       % INDENT (empty value is the same as 0pt)
{\bfseries} % HEADFONT
{}         % HEADPUNCT
{2pt plus 1pt minus 1pt} % HEADSPACE
{}          % CUSTOM-HEAD-SPEC

\theoremstyle{plain}
\newtheorem{lemma}{Lemma}
\newtheorem{theorem}{Theorem}
\theoremstyle{noindent}
\newtheorem{lemma-noindent}{Lemma}
\newtheorem{theorem-noindent}{Theorem}
\theoremstyle{definition-compressed}
\newtheorem{definition}{Definition}

% The protocol command creates red protocol boxes with rounded edges
\fboxset{rounded,outer-width=\linewidth, border-color=red, padding-top=3pt, padding-bottom=3pt}
\newcommand{\protocol}[1]{
{\centering
        \vspace{1mm}
        \lfbox{
            \begin{minipage}{35em}
                #1
              \end{minipage}
            }
            $ $\vspace{1mm}
            }
}

% Creates a pprof sketch environment
\newenvironment{sketch}{%
  \renewcommand{\proofname}{Proof sketch}\proof}{\endproof}

% Appendix
\addcontentsline{toc}{chapter}{Appendix}




% Code Snippet Listings
% ================================================

\lstdefinelanguage{thrift}
    {morekeywords={struct,Distribution},
    sensitive=false,
    morecomment=[l]{//},
    morecomment=[s]{/*}{*/},
    morestring=[b]",
}

\lstdefinestyle{placement}{
  float=tp,
  floatplacement=tbp,
%   abovecaptionskip=-5pt
}

\lstset{frame=tb,
  language=thrift,
  aboveskip=3mm,
  belowskip=3mm,
  showstringspaces=false,
  columns=flexible,
  basicstyle={\small\ttfamily},
  numbers=none,
  numberstyle=\tiny\color{gray},
  keywordstyle=\color{blue},
  commentstyle=\color{codegreen},
  stringstyle=\color{mauve},
  breaklines=true,
  breakatwhitespace=true,
  tabsize=3
}

% Tikz relative node positioning
% ================================================

\tikzset{
    position/.style args={#1:#2 from #3}{
        at=(#3.#1), anchor=#1+180, shift=(#1:#2)
    }
}
% ================================================


% Project-specific commands
% ================================================
\newcommand{\sys}{MySystem\xspace}
% ================================================
